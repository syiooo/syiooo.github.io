
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://www.sy-study.top/5_CG/13%20-%20%E9%87%87%E6%A0%B7/">
      
      
        <link rel="prev" href="../12%20-%20%E5%9B%BE%E5%BD%A2%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">
      
      
        <link rel="next" href="../14%20-%20PBR%EF%BC%9A%E5%9F%BA%E4%BA%8E%E7%89%A9%E7%90%86%E7%9A%84%E6%B8%B2%E6%9F%93/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>13 - 采样 - Sy_Blog&Notes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Serif+SC:300,300i,400,400i,700,700i%7CNoto+Sans+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Noto Serif SC";--md-code-font:"Noto Sans Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#13-" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Sy_Blog&amp;Notes" class="md-header__button md-logo" aria-label="Sy_Blog&Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Sy_Blog&Notes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              13 - 采样
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
    
  
  首页

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../1_Math/%E3%80%90Math%E3%80%91%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0%E5%9F%BA%E7%A1%80%E6%95%B4%E7%90%86/" class="md-tabs__link">
          
  
  
    
  
  1 Math

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../2_English/%E5%A4%96%E5%88%8A/%E3%80%90Guardian%E3%80%91Israel-strikes-Syria%E2%80%99s-defence-ministry-in-third-day-of-attacks/" class="md-tabs__link">
          
  
  
    
  
  2 English

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../3_408/CSAPP/" class="md-tabs__link">
          
  
  
    
  
  3 408

        </a>
      </li>
    
  

    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../4_Experience/" class="md-tabs__link">
          
  
  
    
  
  4 Experience

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../1%20%26%202%20-%20%E4%BB%8B%E7%BB%8D%E4%B8%8E%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/" class="md-tabs__link">
          
  
  
    
  
  5 CG

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../blog/" class="md-tabs__link">
          
  
  
    
  
  Blog

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Sy_Blog&amp;Notes" class="md-nav__button md-logo" aria-label="Sy_Blog&Notes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Sy_Blog&Notes
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
  
  <span class="md-ellipsis">
    首页
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../1_Math/%E3%80%90Math%E3%80%91%E4%B8%89%E8%A7%92%E5%87%BD%E6%95%B0%E5%9F%BA%E7%A1%80%E6%95%B4%E7%90%86/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    1 Math
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../2_English/%E5%A4%96%E5%88%8A/%E3%80%90Guardian%E3%80%91Israel-strikes-Syria%E2%80%99s-defence-ministry-in-third-day-of-attacks/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    2 English
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    
  
  
  
    <a href="../../3_408/CSAPP/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    3 408
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../4_Experience/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    4 Experience
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    5 CG
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            5 CG
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../1%20%26%202%20-%20%E4%BB%8B%E7%BB%8D%E4%B8%8E%E6%95%B0%E5%AD%A6%E5%9F%BA%E7%A1%80/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    1 &amp; 2 - 介绍与数学基础
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10%20-%20%E4%BF%A1%E5%8F%B7%E5%A4%84%E7%90%86/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    10 - 信号处理
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../11%20-%20%E7%BA%B9%E7%90%86%E6%98%A0%E5%B0%84/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    11 - 纹理映射
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../12%20-%20%E5%9B%BE%E5%BD%A2%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    12 - 图形数据结构
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    13 - 采样
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    13 - 采样
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#131" class="md-nav__link">
    <span class="md-ellipsis">
      13.1 积分（整大章都没看懂。。。）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.1 积分（整大章都没看懂。。。）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1311" class="md-nav__link">
    <span class="md-ellipsis">
      13.1.1 积分与度量
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1312-2-d" class="md-nav__link">
    <span class="md-ellipsis">
      13.1.2 例子：在 2 D 平面上测量直线
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#132" class="md-nav__link">
    <span class="md-ellipsis">
      13.2 连续概率
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#133" class="md-nav__link">
    <span class="md-ellipsis">
      13.3 蒙特卡洛积分
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.3 蒙特卡洛积分">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1331" class="md-nav__link">
    <span class="md-ellipsis">
      13.3.1 准蒙特卡洛积分
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#134" class="md-nav__link">
    <span class="md-ellipsis">
      13.4 挑选随机点
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.4 挑选随机点">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1341" class="md-nav__link">
    <span class="md-ellipsis">
      13.4.1 函数反转
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1342-rejection" class="md-nav__link">
    <span class="md-ellipsis">
      13.4.2 排斥（Rejection）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1343-metropoliswhat" class="md-nav__link">
    <span class="md-ellipsis">
      13.4.3 Metropolis（what ？？？）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1344" class="md-nav__link">
    <span class="md-ellipsis">
      13.4.4 示例：在正方形中选择随机直线
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../14%20-%20PBR%EF%BC%9A%E5%9F%BA%E4%BA%8E%E7%89%A9%E7%90%86%E7%9A%84%E6%B8%B2%E6%9F%93/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    14 - PBR：基于物理的渲染
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../15%20-%20%E6%9B%B2%E7%BA%BF/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    15 - 曲线
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../16%20-%20%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8A%A8%E7%94%BB/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    16 - 计算机动画
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../17%20-%20%E4%BD%BF%E7%94%A8%E5%9B%BE%E5%BD%A2%E7%A1%AC%E4%BB%B6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    17 - 使用图形硬件
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../18%20-%20%E8%89%B2%E5%BD%A9/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    18 - 色彩
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../19%20-%20%E8%A7%86%E8%A7%89%E6%84%9F%E7%9F%A5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    19 - 视觉感知
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../20%20-%20%E8%89%B2%E8%B0%83%E9%87%8D%E6%9E%84/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    20 - 色调重构
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../21%20-%20%E9%9A%90%E5%BC%8F%E5%BB%BA%E6%A8%A1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    21 - 隐式建模
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../22%20-%20%E6%B8%B8%E6%88%8F%E4%B8%AD%E7%9A%84%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9B%BE%E5%BD%A2%E5%AD%A6/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    22 - 游戏中的计算机图形学
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../23%20-%20%E5%8F%AF%E8%A7%86%E5%8C%96/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    23 - 可视化
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../3%20-%20%E5%85%89%E6%A0%85%E5%9B%BE%E5%83%8F/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    3 - 光栅图像
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../4%20-%20%E5%85%89%E7%BA%BF%E8%BF%BD%E8%B8%AA/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    4 - 光线追踪
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../5%20-%20%E8%A1%A8%E9%9D%A2%E7%9D%80%E8%89%B2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    5 - 表面着色
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../6%20%26%207%20-%20%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E4%B8%8E%E5%8F%98%E6%8D%A2%E7%9F%A9%E9%98%B5/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    6 &amp; 7 - 线性代数与变换矩阵
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../8%20-%20%E8%A7%86%E5%9B%BE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    8 - 视图
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../9%20-%20%E5%9B%BE%E5%BD%A2%E7%AE%A1%E7%BA%BF/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    9   图形管线
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../index.md/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Index.md
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
  
    <a href="../../blog/" class="md-nav__link">
      
  
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#131" class="md-nav__link">
    <span class="md-ellipsis">
      13.1 积分（整大章都没看懂。。。）
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.1 积分（整大章都没看懂。。。）">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1311" class="md-nav__link">
    <span class="md-ellipsis">
      13.1.1 积分与度量
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1312-2-d" class="md-nav__link">
    <span class="md-ellipsis">
      13.1.2 例子：在 2 D 平面上测量直线
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#132" class="md-nav__link">
    <span class="md-ellipsis">
      13.2 连续概率
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#133" class="md-nav__link">
    <span class="md-ellipsis">
      13.3 蒙特卡洛积分
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.3 蒙特卡洛积分">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1331" class="md-nav__link">
    <span class="md-ellipsis">
      13.3.1 准蒙特卡洛积分
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#134" class="md-nav__link">
    <span class="md-ellipsis">
      13.4 挑选随机点
    </span>
  </a>
  
    <nav class="md-nav" aria-label="13.4 挑选随机点">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1341" class="md-nav__link">
    <span class="md-ellipsis">
      13.4.1 函数反转
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1342-rejection" class="md-nav__link">
    <span class="md-ellipsis">
      13.4.2 排斥（Rejection）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1343-metropoliswhat" class="md-nav__link">
    <span class="md-ellipsis">
      13.4.3 Metropolis（what ？？？）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#1344" class="md-nav__link">
    <span class="md-ellipsis">
      13.4.4 示例：在正方形中选择随机直线
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="13-">13 - 采样<a class="headerlink" href="#13-" title="Permanent link">&para;</a></h1>
<blockquote>
<p>[!important] 这章在讲什么？
首先来考虑一个很现实的问题：我想在圆盘上均匀的采样某个属性的均值，怎么采？
一想到在圆盘上可以轻松的使用极坐标系，我们就干脆的把点表示为 <span class="arithmatex">\((r,\theta)\)</span>
接下来利用加权积分就完成了：<span class="arithmatex">\(<span class="arithmatex">\(\bar{Attr}= \frac{\int\int_{circle}\,Attr(r,\theta)\,drd\theta}{\int\int_{circle}\,drd\theta}\)</span>\)</span>
但是这个式子确实有点小问题——他对 r 的采样是不公平的（但是对角度的采样是公平的）
来看个实际的例子就明白了，下图中我们对 <span class="arithmatex">\(r-\theta\)</span> 空间中的一个矩形区域进行了均匀采样。
<img alt="" src="pic/Pasted%20image%2020240326142814.png" />
当这些点转换到 XOY 空间时，它们的分布如下图所示，可以看到：距离圆心的地方分布的点非常密集，而远离圆心的地方反而没什么点分布。
显然，这对圆盘来说不是均匀的采样。
对 <span class="arithmatex">\(r\)</span> 和 <span class="arithmatex">\(\theta\)</span> 均匀采样无法得到在圆盘上均匀分布的采样，换言之，想要在圆盘上实现均匀采样，就必须在 <span class="arithmatex">\(r-\theta\)</span> 空间上实现<strong>不均匀采样</strong>。
<img alt="" src="pic/Pasted%20image%2020240326142829.png" />
因此本章的主题（主要目标）就呼之欲出了——我们想找到一对新的参数 <span class="arithmatex">\(\xi_1\)</span> 和 <span class="arithmatex">\(\xi_2\)</span>，当我们在 <span class="arithmatex">\(\xi_1\)</span> 和 <span class="arithmatex">\(\xi_2\)</span> 上均匀采样时，等价于在圆盘上均匀采样。
<span class="arithmatex">\(<span class="arithmatex">\(\xi_1=f_1(r,\theta)\)</span>\)</span> &gt; <span class="arithmatex">\(<span class="arithmatex">\(\xi_2=f_2(r,\theta)\)</span>\)</span>
在圆盘上采样随机点很抽象、也不直观，但是在 <span class="arithmatex">\(r-\theta\)</span> 空间上的矩形区域上采样既直观又容易理解。复杂分布上的随机点对应到简单分布上的随机点，称为准随机点。使用准随机点计算的蒙特卡洛积分称为准蒙特卡洛积分。</p>
<hr />
<p>本章给出了 3 种转换分布的方法（挑选准随机点）：逆函数法、Rejection 和 Metropolis 采样法。这里我们介绍逆函数法。
概率分布函数可以把变量映射到 0 到 1 的空间上。虽然变量出现各种值的机会是不均匀的，但是概率数字在 0 到 1 上是均匀的（难道说 0.99 这个数字在概率上比 0.01 更常见吗？）
我们利用反函数，采样概率数字，反求出变量的值。</p>
<p>回到一开始的示例！我想在一个圆盘中均匀采样，但是使用 <span class="arithmatex">\(r-\theta\)</span> 2 个变量来采样肯定是不均匀的，我想找到 2 个新的变量 <span class="arithmatex">\(\xi_1-\xi_2\)</span>，使得在 <span class="arithmatex">\(\xi_1-\xi_2\)</span> 空间的矩形中均匀采样，能得到在圆盘中均匀分布的点。
首先，点在圆盘中是均匀的，那么它的概率密度函数等于面积的倒数：
<span class="arithmatex">\(<span class="arithmatex">\(f(r,\theta)=\frac{1}{\pi R^2}\)</span>\)</span>
接下来求 2 个变量的边缘分布函数：
<span class="arithmatex">\(<span class="arithmatex">\(F(r)=F(r,\theta_{max})=\int_0^r\int_0^{2\pi}\,f(r,\theta)r\,drd\theta=\frac{r^2}{R^2}\)</span>\)</span> &gt; <span class="arithmatex">\(<span class="arithmatex">\(F(\theta)=F(r_{max},\theta)=\int_0^{\theta}\int_0^R f(r,\theta)r \,d\theta dr=\frac{\theta}{2\pi}\)</span>\)</span>
接下来，我们令 <span class="arithmatex">\(\xi_1-\xi_2\)</span> 分别等于两个边缘分布函数：
<span class="arithmatex">\(<span class="arithmatex">\(\xi_1=\frac{r^2}{R^2}\)</span>\)</span> &gt; <span class="arithmatex">\(<span class="arithmatex">\(\xi_2=\frac{\theta}{2\pi}\)</span>\)</span>
解出 <span class="arithmatex">\(r-\theta\)</span>：
<img alt="" src="pic/Pasted%20image%2020240326153745.png" />
这意味着，我们可以在 <span class="arithmatex">\(\xi_1-\xi_2\)</span> 上均匀采样，再使用上式转换出 <span class="arithmatex">\(r-\theta\)</span> 的坐标，便可以在圆盘上均匀采样。
<img alt="" src="pic/Pasted%20image%2020240326154423.png" /> &gt; <img alt="" src="pic/Pasted%20image%2020240326154431.png" /></p>
</blockquote>
<p>图形中的许多应用程序需要对不寻常的空间进行“公平”采样，例如所有可能的线的空间。
例如，我们可能需要在一个像素内生成随机的边线，或者在一个像素上根据一些密度函数产生密度变化的随机样本点。
本章提供了这种概率运算的机制。这些技术对于使用蒙特卡罗积分对复杂积分进行数值计算也很有用，这也将在本章中介绍。</p>
<h2 id="131">13.1 积分（整大章都没看懂。。。）<a class="headerlink" href="#131" title="Permanent link">&para;</a></h2>
<h3 id="1311">13.1.1 积分与度量<a class="headerlink" href="#1311" title="Permanent link">&para;</a></h3>
<h3 id="1312-2-d">13.1.2 例子：在 2 D 平面上测量直线<a class="headerlink" href="#1312-2-d" title="Permanent link">&para;</a></h3>
<p><span class="arithmatex">\(<span class="arithmatex">\(AvgLength=\frac{\int_{L\in [0,1]^2}\,length(L)d\mu(L)}{\int_{L\in [0,1]^2}\,d\mu(L)}\)</span>\)</span>
何为 <span class="arithmatex">\(\mu\)</span> 的自然度量？
如果你把直线看作 <span class="arithmatex">\(y=mx+b\)</span>，那么点 <span class="arithmatex">\((m,b)\)</span> 就位于“斜率-截距”空间，一个简单的度量就是 dm 和 db。然而这不是一个好的度量方法，因为不是所有相等大小的线束都有相同的度量。更准确地说，坐标系的变化不会是不变的。
例如，如果你把所有的线都穿过正方形，那么穿过正方形的线的度量就不会和穿过一个旋转的单位正方形的度量一样，我们真正想要的是一个公平的度量方法这一概念在图 13—1 和图 13—2 中得到了说明。
<img alt="" src="pic/Pasted%20image%2020240325151841.png" /></p>
<blockquote>
<p>13.1 中的两捆线应当由相同的度量，但是它们在截距上的步进不一样，所以用 db 是不公平的。
13.2 中，但是它们在斜率（<span class="arithmatex">\(m=\tan{\theta}\)</span>）上的步进不一样，转角的步进才是一样的，所以用 dm 也是不公平的。</p>
</blockquote>
<h2 id="132">13.2 连续概率<a class="headerlink" href="#132" title="Permanent link">&para;</a></h2>
<h2 id="133">13.3 蒙特卡洛积分<a class="headerlink" href="#133" title="Permanent link">&para;</a></h2>
<p>用过量的采样来近似期望的结果：
<img alt="" src="pic/Pasted%20image%2020240325165059.png" />
以上式子的形式有点尴尬；我们通常希望近似单个函数 g 的积分而不是乘积 fp。
$$\int_{S}g(x)dA=\frac{1}{N} \sum \frac{g(x_i)}{p(x_i)} $$
为了得到一个好的估计，我们希望尽可能多的样本，并且我们希望 g/p 具有低方差（g 和 p 应该具有相似的分布）。
智能地选择 p 函数称为重要性采样。
以上式子还显示了蒙特卡洛积分的基本问题：收益递减。由于估计的方差与 1/N 成正比，标准差与 1/√N 成正比。由于误差类似于标准偏差，我们需要 4 倍的采样才能使误差下降一半。</p>
<p>另一种减少方差的方法是将积分的域 S 划分为几个更小的域 Si，并将积分评估为 Si 上的积分之和。这被称为分层采样，在这种情况下，估计的方差为
<img alt="" src="pic/Pasted%20image%2020240325170115.png" /></p>
<p>图形中分层采样最常见的例子是像素采样的抖动。
函数 p 的形状对 N 个样本估计方差的影响如表 13.1 所示。注意，当 p 的形状与 g 的形状相似时，方差减小。如果 p = g/I，方差下降到零
<img alt="" src="pic/Pasted%20image%2020240325170421.png" />
一个重要原则是分层采样通常远远优于重要性采样
对于分层采样的方差，没有一个良好的结论说明它和抽样数之间的关系到底如何。
某些情况下分层采样运行地不是很好，比如白噪声，积分的结果在所有区间上拥有相同的方差。
另一方面，大多数函数将从分层采样中受益，因为每个子单元的方差通常小于整个域的方差。</p>
<h3 id="1331">13.3.1 准蒙特卡洛积分<a class="headerlink" href="#1331" title="Permanent link">&para;</a></h3>
<p>一种流行的求积方法是将蒙特卡罗积分中的随机点替换为准随机点。
这些点是确定性的，但在某种意义上是均匀的。例如，在单位平方面积上，一组 N 个准随机点应该在正方形内的区域 A 上具有以下属性：
<img alt="" src="pic/Pasted%20image%2020240325171240.png" />
例如，栅格中的一组常规样本具有此属性。</p>
<p>准随机点可以提高许多集成应用中的性能。有时，必须小心以确保它们不会引入混叠。
特别好的一点是，在那些需要随机采样或是分层采样的情况下，可以将采样点替换为准随机点，而无需任何改动。</p>
<p>激发准蒙特卡罗积分的关键直觉是，在估计被积函数的平均值时，只要它们是“公平的”，任何样本集都将这样做。</p>
<blockquote>
<p>求函数均值的关键是：采样点要均匀。</p>
</blockquote>
<h2 id="134">13.4 挑选随机点<a class="headerlink" href="#134" title="Permanent link">&para;</a></h2>
<p>我们经常希望在单位正方形上生成一组随机或伪随机点，用于分布射线跟踪等应用。有几种方法可以做到这一点，例如抖动。</p>
<p>有时，我们的采样空间可能不是正方形（例如，圆形透镜），也可能不均匀（例如，以像素为中心的滤波器函数）。
如果我们可以写成一个数学变换，它将我们的等分布点(ui, vi)作为输入，输出所需空间上以所需密度分布的一组点。例如，为了对相机镜头进行采样，变换将取(ui, vi)和输出(ri, φi)，使新点近似均匀分布在透镜的圆盘上。
<img alt="" src="pic/Pasted%20image%2020240325172737.png" />
它有一个严重的问题。虽然这些点确实覆盖了镜头，但它们不均匀。
在这种情况下，我们需要的是一个在正方形上取均匀分布到新域上的均匀分布，这样的变换。</p>
<p>生成不均匀点或生成不规则形状上的均匀点，有几种办法
以下部分回顾了最常用的三个：函数反转、排斥和 Metropolis。</p>
<h3 id="1341">13.4.1 函数反转<a class="headerlink" href="#1341" title="Permanent link">&para;</a></h3>
<p>如果密度 f (x)是一维的，我们可以从一组均匀随机数 ξi 生成密度为 f 的随机数 αi，其中 ξi∈[0,1]。为此，我们需要累积概率分布函数 P (x)：
<span class="arithmatex">\(<span class="arithmatex">\(Probability(\alpha\lt x)=P(x)=\int_{x_min}^x f(x')d\mu\)</span>\)</span>
为了获得 αi，我们简单地变换 ξi：
<span class="arithmatex">\(<span class="arithmatex">\(\alpha_i=P^{-1}(\xi_i)\)</span>\)</span>
如果 P 不是解析可逆的，那么数值方法就足够了，因为所有有效概率分布函数都存在逆。</p>
<p>所以我们可以“扭曲”一组规范随机数（ξ1，., ξN ) 到适当分布的数字
<img alt="" src="pic/Pasted%20image%2020240325191335.png" />
当然，同样的扭曲函数可以用来将“均匀”抖动的样本转换为具有所需密度的良好分布样本。</p>
<p>对于二维的例子：
<span class="arithmatex">\(<span class="arithmatex">\(Probability(\alpha_x\lt x \space and \space \alpha_y\lt y)=F(x,y)=\int_{x_min}^x \int_{y_min}^y f(x',y')d\mu(x',y')\)</span>\)</span>
回到我们之前的示例，假设我们正在从半径为 R 的圆盘均匀采样,二维分布函数是：
<img alt="" src="pic/Pasted%20image%2020240325192500.png" />
此时我们在标准域上的点可以被转换到圆盘上：
<img alt="" src="pic/Pasted%20image%2020240325192547.png" /></p>
<blockquote>
<p>做完这个变化之后，分布函数变成
<span class="arithmatex">\(<span class="arithmatex">\(F(r_0,\phi_0)=F(\xi_i,\xi_2)= \frac{\phi r^2}{2\pi R^2} =\frac{2\pi\xi_1 (R\sqrt{\xi_2})^2}{2\pi R^2}=\xi_1\xi_2\)</span>\)</span>
正好等同于方形均匀分布的概率。</p>
<p>[!note] 123
二维分布可以出两个 0 到 1 的值，分别另两个自变量取 max
<span class="arithmatex">\(<span class="arithmatex">\(F(r,\phi)=\frac{\phi r^2}{2\pi R^2}\)</span>\)</span> &gt; <span class="arithmatex">\(<span class="arithmatex">\(F(max,\phi)=\frac{\phi R^2}{2\pi R^2}= \frac{\phi}{2\pi}=\xi_1\)</span>\)</span> &gt; <span class="arithmatex">\(<span class="arithmatex">\(F(r,max)=\frac{2\pi r^2}{2\pi R^2}= \frac{r^2}{R^2}=\xi_2\)</span>\)</span></p>
</blockquote>
<p>为了为一些真实的渲染应用程序选择反射射线方向，我们根据密度选择单位半球上的点：
<img alt="" src="pic/Pasted%20image%2020240325192835.png" />
其中 n 是类似 Phong 的指数，θ 是表面法线的角度，θ ∈[0, π/2]（位于上半球），φ 是方位角 (φ ∈ [0, 2π])。累积分布函数为（r=1）
<img alt="" src="pic/Pasted%20image%2020240325193855.png" />
同样的我们建立标准域到该分布的变换：
<img alt="" src="pic/Pasted%20image%2020240325195130.png" />
同样，关于这一点的一个很好的事情是，单位正方形上的一组抖动点可以很容易地转换为具有所需分布的半球上的一组抖动点。
请注意，如果 n 设置为 1，我们有漫反射分布，因为通常需要。</p>
<p>作为效率的提高，我们可以避免取逆三角函数的三角函数（例如 cos (arccos θ))。例如，当 n = 1(a 漫反射分布) 时，有
<img alt="" src="pic/Pasted%20image%2020240325200347.png" /></p>
<h3 id="1342-rejection">13.4.2 排斥（Rejection）<a class="headerlink" href="#1342-rejection" title="Permanent link">&para;</a></h3>
<p>排斥法根据一些简单的分布选择点，并拒绝其中一些分布更复杂的点。有几种使用拒绝的场景，我们通过示例展示了其中一些场景。</p>
<p>假设我们希望单位圆内的均匀随机点。我们可以选择均匀随机点 (x, y) ∈ [−1, 1]^2 并拒绝圆外的点。</p>
<p>尽管拒绝方法通常对代码简单，但它很少与分层兼容。
出于这个原因，它倾向于收敛得更慢，因此应该主要用于调试或特别困难的情况。</p>
<h3 id="1343-metropoliswhat">13.4.3 Metropolis（what ？？？）<a class="headerlink" href="#1343-metropoliswhat" title="Permanent link">&para;</a></h3>
<!--
Metropolis 方法使用随机突变来产生一组具有所需密度的样本。这个概念广泛用于本章笔记中引用的 Metropolis 光传输算法。

假设我们在域 S 中有一个随机点 x 0。此外，假设对于任何点 x，我们有一种方法来生成随机 y ∼ px。我们使用边际符号 px(y) ≡ p(x → y) 来表示这个密度函数。现在，假设我们让 x 1 是具有潜在密度 p(x 0 → x 1) 选择的 S 中的随机点。我们用密度 p(x 1 → x 0) 生成 x 2，依此类推。在我们生成无限数量的样本的极限中，可以证明样本将有一些由 p 确定的底层密度，而不管初始点 x 0。

现在，假设我们想选择 p 使得我们收敛的样本的底层密度与函数 f (x) 成正比，其中 f 是域 S 的非负函数。此外，假设我们可以评估 f ，但我们几乎没有或没有关于其属性的额外知识（这些功能在图形中很常见）。此外，假设我们能够利用底层密度函数 t(xi→xi+1)从 xi 到 xi+1 进行“转换”。为了添加灵活性，进一步假设我们添加了 xi 转换到自身的潜在非零概率，即 xi+1 = xi。我们将此表述为以概率 a(xi → y) 生成潜在候选 y ∼ t(xi → y) 和“接受”这个候选（即 xi+1 = y），并以概率 1 - a(xi → y) 拒绝它（即 xi+1 = xi）。请注意，sequencex 0, x 1, x 2,。将是一个随机集，但样本之间会有某种相关性。它们仍然适用于蒙特卡洛积分或密度估计，但分析这些估计的方差更具挑战性。
-->

<blockquote>
<p>[!note] 123
直接看笔记，关于马尔可夫链与 Metropolis 采样
<a href="马尔可夫链与%20Metropolis%20采样.md">马尔可夫链与 Metropolis 采样</a></p>
</blockquote>
<h3 id="1344">13.4.4 示例：在正方形中选择随机直线<a class="headerlink" href="#1344" title="Permanent link">&para;</a></h3>
<blockquote>
<p>[!important] 123
在这个问题中，<span class="arithmatex">\(\theta-r\)</span> 这两个轴上采样已经是均匀的了，但是采样的区域不是标准的 <span class="arithmatex">\([0,1]^2\)</span> 的正方形，我们仍然要对这两个轴进行变换。</p>
</blockquote>
<p>作为设计抽样策略的完整过程的一个例子，考虑寻找与单位正方形[0,1]^2 相交的随机线的问题。我们希望这个过程是公平的;也就是说，我们希望直线在正方形内均匀分布。
直觉上，我们可以看出这个问题有些微妙之处——在斜角上比在水平或垂直方向上有“更多”的线。这是因为正方形的横截面不是均匀的。</p>
<blockquote>
<p>斜率 45 度的时候，可以穿过最多的直线，因为截面宽度是根号 2</p>
</blockquote>
<p>我们的第一个目标是找到一个逆函数的方法，如果它不存在，我们再依靠 Rejection 或 Metropolis 方法。这是因为我们希望在线空间中有分层的样本。</p>
<p>我们首先尝试使用法向坐标系，因为在正方形中选择随机线的问题等同于——在 <span class="arithmatex">\((r,\phi)\)</span> 空间中找到均匀分布的点的问题。</p>
<p>考虑 <span class="arithmatex">\(-\pi /2\lt\theta\lt0\)</span> 的区域。r 的值需要是多少才能击中方形区域？答案是：<span class="arithmatex">\(r\lt \cos{\theta}\)</span>，对于其他四个象限也是一样的。我们能找到角度所对应的最大的 r 值：
<img alt="" src="pic/Pasted%20image%2020240326111554.png" />
<img alt="" src="pic/Pasted%20image%2020240326111825.png" /></p>
<blockquote>
<p>在以上凸形分布上均匀采样，就能得到均与分布的与正方形相交的直线。</p>
</blockquote>
<p>先求 <span class="arithmatex">\(\theta\)</span> 的边缘分布：
<span class="arithmatex">\(<span class="arithmatex">\(p(\theta)=\frac{r_{max}(\theta)}{\int_{-\pi}^\pi \,r_{max}(\theta)d\theta}\)</span>\)</span>
<img alt="" src="pic/1711423861659.jpg" />
接下来求 <span class="arithmatex">\(\theta\)</span> 的概率分布函数：
<img alt="" src="pic/Pasted%20image%2020240326113322.png" />
现在我们可以通过逆函数计算标准空间的一个轴 <span class="arithmatex">\(\xi_1\)</span>：
<img alt="" src="pic/Pasted%20image%2020240326113551.png" /></p>
<p>正如前面所讨论的，这条线有许多参数化，每个参数化都有一个与之对应的“公平”度量。
我们也可以在这些空间中生成随机的线条。
例如，在斜截空间中。通过与正态空间相似的推理，斜率的密度函数为
<img alt="" src="pic/Pasted%20image%2020240326114254.png" />
<img alt="" src="pic/Pasted%20image%2020240326114304.png" /></p>







  
  






  <h2 id="__comments">Comments</h2>
  <!-- Insert generated snippet here -->
  <script src="https://giscus.app/client.js"
        data-repo="syiooo/syiooo.github.io"
        data-repo-id="R_kgDOPeemcg"
        data-category="Show and tell"
        data-category-id="DIC_kwDOPeemcs4CuRNW"
        data-mapping="pathname"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="0"
        data-input-position="top"
        data-theme="preferred_color_scheme"
        data-lang="zh-CN"
        data-loading="lazy"
        crossorigin="anonymous"
        async>
</script>
  <!-- Synchronize Giscus theme with palette -->
  <script>
    var giscus = document.querySelector("script[src*=giscus]")

    // Set palette on initial load
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate"
        ? "transparent_dark"
        : "light"

      // Instruct Giscus to set theme
      giscus.setAttribute("data-theme", theme) 
    }

    // Register event handlers after documented loaded
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate"
            ? "transparent_dark"
            : "light"

          // Instruct Giscus to change theme
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>

                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant.progress", "navigation.tracking", "navigation.prune", "navigation.indexes", "toc.follow", "navigation.top", "content.code.copy", "content.code.select", "navigation.tabs", "content.footnote.tooltips"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>